---
title: 開発環境
date: '2021-01-01'
type: book
weight: 20
---

ロボットシステムの開発環境に使われている要素の概要を理解する
<!--more-->

## スライド
https://docs.google.com/presentation/d/1-q6zq3vV91GTj7mw9uqwT4B8LyHDpFHBNVi4lEyCa5A/edit?usp=sharing

## Learn

### Linuxコマンド
| command |　説明 | option |
| ------- | ---- | ------ |
| ls      | ディレクトリ内のファイル・ディレクトリの表示 |  -l: 詳細を表示 -a: 全て表示|
| mkdir   | ディレクトリ作成 |  |
| cd      | ディレクトリ移動 |  |
| mv      | ファイル移動 |  |
| rm      | ファイル削除 | -r:ディレクトリ内を再起的に削除 -f:強制削除 |
| cat     |  |  |
|  |  |  |

### ssh

```
ssh <username>@<hostname> -p <port> -i <identity_file>
```

### エディタ
- vim
    - チュートリアル： `vimtuter`
- emacs

### git/GitHub
- gitとは
    - add
    - push
    - pull
    - fetch
    - clone
    - merge
    - reset
- GitHubとは
    - 

### docker
- Dockerとは

- DockerFileのビルド
    ```
    docker build -t <image_name>:<tag_name> -f <Dockerfile> <relative_dir>
    ```

- Docker Image
    ```
    # Docker image一覧
    docker images
    # Docker Imageのダウンロード
    docker pull <image_name>:<tag_name>
    # 削除
    docker rmi <image_id>
    # 不要なDocker imageを消す
    docker image prune
    ```

- Docker Container
    ```
    # Docker containerの起動
    docker run <image_name> <command>
    # Docker container一覧
    docker ps -a
    # Docker containerに接続
    docker exec -it <container_name> bash
    ```

    ※`docker run`でよく使うオプション
    - `-it` 
        - 標準入出力有効になる
    - `--name <container_name>`
        - コンテナの名前の指定
    - `--rm`
        - コンテナを抜けた際に自動的にコンテナを削除する
    - `--gpus all`
        - コンテナに全gpuを渡す
        - gpuの個数を指定する場合は all の代わりに数字(0, 1,...)
        - gpuを指定する場合は `--gpus '"device=0,1"'`
    - `-v <host/path/to/dir:container/path/to/dir>`
        - コンテナ内にホストのディレクトリをマウントする
    - `-p <host_port>:<container_port>`
        - ホストのポートをコンテナのポートにマップする
        - コンテナ内でwebサーバを動かす場合などに使う
    - `--net=host`
        - コンテナとホストでネットワークを共有する(IPアドレスなどが同じになる)
        - ROSノードをコンテナ内で動かす場合などはこれを使うと楽
    - `--privileged`
        - コンテナからのデバイスへのアクセスを許可
        - コンテナからWEBカメラにアクセスしたいときなど



## 演習

{{< spoiler text="【ssh】開発用PCにsshする" >}}
```shell
vim ~/.ssh/config
ssh robot_dev2
```
{{< /spoiler >}}

{{< spoiler text="【Linuxコマンド】個人のディレクトリを作成し移動する" >}}

```shell
robot_dev2@robot-dev2:~$ mkdir yikeda
robot_dev2@robot-dev2:~$ cd yikeda
```
{{< /spoiler >}}

{{< spoiler text="【git】roomba_hackリポジトリをcloneし移動する" >}}

```shell
robot_dev2@robot-dev2:~/yikeda$ git clone https://github.com/matsuolab/roomba_hack.git
robot_dev2@robot-dev2:~/yikeda$ cd roomba_hack
```
{{< /spoiler >}}

{{< spoiler text="【git】devブランチにcheckoutする" >}}

```shell
robot_dev2@robot-dev2:~/yikeda/roomba_hack$ git checkout dev
```
{{< /spoiler >}}

{{< spoiler text="【docker】roomba_hackの開発環境のdocker imageをビルドする" >}}

```
robot_dev2@robot-dev2:~/yikeda/roomba_hack$ ./BUILD-DOCKER-IMAGE.sh
```
{{< /spoiler>}}


{{< spoiler text="【ssh】jetsonにsshする" >}}
```shell
robot_dev2@robot-dev2:~/yikeda/roomba_hack$ ssh roomba_dev1
```

{{< /spoiler>}}
